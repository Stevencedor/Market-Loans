<div class="movimientos-container">
  <h2>Gestionar Movimientos</h2>
  
  <!-- Formulario para agregar movimientos -->
  <form [formGroup]="movimientoForm" (ngSubmit)="agregarMovimiento()">
    <div class="form-group">
      <label for="monto">Monto</label>
      <input type="number" id="monto" formControlName="monto" required placeholder="0.00" />
      <div *ngIf="movimientoForm.get('monto')?.invalid && movimientoForm.get('monto')?.touched" class="error">
        El monto es obligatorio y debe ser mayor a 0.
      </div>
    </div>
    
    <div class="form-group">
      <label for="tipo">Tipo de movimiento</label>
      <select id="tipo" formControlName="tipo">
        <option value="">-- Seleccionar tipo --</option>
        <option value="INGRESO">üíπ Ingreso</option>
        <option value="GASTO">üìâ Gasto</option>
      </select>
      <div *ngIf="movimientoForm.get('tipo')?.invalid && movimientoForm.get('tipo')?.touched" class="error">
        El tipo es obligatorio.
      </div>
    </div>
    
    <div class="form-group">
      <label for="descripcion">Descripci√≥n</label>
      <input id="descripcion" formControlName="descripcion" required placeholder="Ej. Compra de supermercado" />
      <div *ngIf="movimientoForm.get('descripcion')?.invalid && movimientoForm.get('descripcion')?.touched" class="error">
        La descripci√≥n es obligatoria.
      </div>
    </div>
    
    <div class="form-group">
      <label for="categoria">Categor√≠a</label>
      <select id="categoria" formControlName="categoria">
        <option value="">-- Seleccionar categor√≠a --</option>
        <option *ngFor="let cat of categorias" [ngValue]="cat">{{ cat.nombre }}</option>
      </select>
      <div *ngIf="movimientoForm.get('categoria')?.invalid && movimientoForm.get('categoria')?.touched" class="error">
        La categor√≠a es obligatoria.
      </div>
    </div>
    
    <button type="submit" [disabled]="movimientoForm.invalid || cargando">
      <span *ngIf="cargando" class="spinner"></span>
      Registrar movimiento
    </button>
    
    <div class="success" *ngIf="success">‚úÖ {{ success }}</div>
    <div class="error" *ngIf="error">‚ùå {{ error }}</div>
  </form>
  
  <!-- Secci√≥n de movimientos -->
  <div class="section-header">
    <h3>Movimientos registrados</h3>
  </div>
  
  <!-- Estado de carga -->
  <div *ngIf="loading" class="loading-indicator">
    <div class="spinner spinner-dark"></div>
    <p>Cargando movimientos...</p>
  </div>
    <!-- Tabla de movimientos -->
  <div class="table-responsive" *ngIf="!loading && movimientos.length > 0">
    <table>
      <thead>
        <tr>
          <th>Fecha</th>
          <th>Monto</th>
          <th>Tipo</th>
          <th>Descripci√≥n</th>
          <th>Categor√≠a</th>
        </tr>
      </thead>
    <tbody>
      <tr *ngFor="let mov of movimientos" [ngClass]="{'ingreso-row': mov.tipo === 'INGRESO', 'gasto-row': mov.tipo === 'GASTO'}">
        <td>{{ mov.fecha | date:'dd/MM/yyyy' }}</td>
        <td [ngClass]="{'text-income': mov.tipo === 'INGRESO', 'text-expense': mov.tipo === 'GASTO'}">
          {{ mov.monto | currency:'COP':'symbol':'1.0-0' }}
        </td>
        <td>
          <span class="badge" [ngClass]="{'badge-income': mov.tipo === 'INGRESO', 'badge-expense': mov.tipo === 'GASTO'}">
            {{ mov.tipo === 'INGRESO' ? '‚ÜóÔ∏è Ingreso' : '‚ÜòÔ∏è Gasto' }}
          </span>
        </td>
        <td>{{ mov.descripcion }}</td>
        <td>{{ mov.categoria?.nombre }}</td>      </tr>
    </tbody>
  </table>
  </div>
  
  <!-- Mensaje cuando no hay movimientos -->
  <div *ngIf="!loading && movimientos.length === 0" class="info">
    No hay movimientos registrados.
  </div>
</div>