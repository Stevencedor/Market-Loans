<div class="dashboard-container">
  <h2>Dashboard Financiero</h2>
  
  <!-- Filtro por fechas -->
  <div class="filtro-fechas">
    <h3>Filtrar por período</h3>
    <div class="filtro-form">
      <div class="form-group">
        <label for="fechaInicio">Desde</label>
        <input 
          type="date" 
          id="fechaInicio" 
          [(ngModel)]="fechaInicio" 
          name="fechaInicio"
        >
      </div>
      <div class="form-group">
        <label for="fechaFin">Hasta</label>
        <input 
          type="date" 
          id="fechaFin" 
          [(ngModel)]="fechaFin" 
          name="fechaFin"
        >
      </div>
      <button class="btn-filtrar" (click)="aplicarFiltroFechas()">Aplicar filtro</button>
    </div>
  </div>
  
  <!-- Loader y mensajes de error -->
  <div *ngIf="loading" class="loading-spinner">Cargando datos...</div>
  <div *ngIf="error" class="error-message">{{ error }}</div>
  
  <!-- Resumen de Balance -->
  <div *ngIf="balance && !loading" class="dashboard-section">
    <h3>Resumen de balance</h3>
    <div class="balance-card">
      <div>
        <span>Total Ingresos:</span>
        <strong class="ingreso">{{ balance.totalIngresos | currency:'COP':'symbol':'1.0-0' }}</strong>
      </div>
      <div>
        <span>Total Gastos:</span>
        <strong class="gasto">{{ balance.totalGastos | currency:'COP':'symbol':'1.0-0' }}</strong>
      </div>
      <div>
        <span>Balance:</span>
        <strong [ngClass]="{'positivo': balance.balance >= 0, 'negativo': balance.balance < 0}">
          {{ balance.balance | currency:'COP':'symbol':'1.0-0' }}
        </strong>
      </div>
    </div>
  </div>
  
  <!-- Gráficos -->
  <div *ngIf="!loading && movimientos && movimientos.length > 0" class="dashboard-charts">
    <!-- Gráfico de distribución de gastos por categoría -->
    <div class="chart-container">
      <h3>Distribución de gastos por categoría</h3>
      <canvas
        baseChart
        [data]="pieChartData"
        [type]="pieChartType"
        [options]="pieChartOptions"
      >
      </canvas>
    </div>
    
    <!-- Gráfico de tendencias temporales -->
    <div class="chart-container">
      <h3>Tendencia de ingresos y gastos</h3>
      <canvas
        baseChart
        [data]="lineChartData"
        [options]="lineChartOptions"
        [type]="lineChartType"
      >
      </canvas>
    </div>
  </div>
  
  <!-- Tabla de movimientos recientes -->
  <div *ngIf="!loading && movimientos && movimientos.length > 0" class="dashboard-section">
    <h3>Movimientos recientes</h3>
    <table class="movimientos-table">
      <thead>
        <tr>
          <th>Fecha</th>
          <th>Descripción</th>
          <th>Categoría</th>
          <th>Tipo</th>
          <th>Monto</th>
        </tr>
      </thead>
      <tbody>        <tr *ngFor="let mov of movimientos.slice(0, 5)" [ngClass]="{'ingreso-row': mov.tipo === 'INGRESO', 'gasto-row': mov.tipo === 'GASTO'}">
          <td>{{ mov.fecha | date:'dd/MM/yyyy' }}</td>
          <td>{{ mov.descripcion }}</td>
          <td>{{ getNombreCategoria(mov.categoriaId) }}</td>
          <td>{{ mov.tipo }}</td>
          <td [ngClass]="{'monto-ingreso': mov.tipo === 'INGRESO', 'monto-gasto': mov.tipo === 'GASTO'}">
            {{ mov.monto | currency:'COP':'symbol':'1.0-0' }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  
  <!-- Mensaje si no hay movimientos -->
  <div *ngIf="!loading && (!movimientos || movimientos.length === 0)" class="empty-state">
    <p>No hay movimientos para mostrar en el período seleccionado.</p>
    <button class="btn-primary" [routerLink]="['/movimientos']">Crear un movimiento</button>
  </div>
</div>