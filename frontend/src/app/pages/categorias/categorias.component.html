<div class="categorias-container">
  <h2>Administraci√≥n de Categor√≠as</h2>

  <!-- Mensajes flotantes/temporales -->
  <div class="message-container-floating">
    <div class="success-toast" *ngIf="successMessage">
      {{ successMessage }}
    </div>
    <div class="error-toast" *ngIf="errorMessage">
      {{ errorMessage }}
    </div>
  </div>

  <!-- Formulario para agregar/editar categor√≠as -->
  <form (ngSubmit)="onSubmit()" #categoriaForm="ngForm">
    <h3>{{ modoEdicion ? 'Editar Categor√≠a' : 'Agregar Nueva Categor√≠a' }}</h3>
    <div class="form-group">
      <label for="nombre">Nombre de categor√≠a</label>
      <input 
        id="nombre"
        [(ngModel)]="categoriaEnFormulario.nombre" 
        name="nombre" 
        required 
        placeholder="Ej. Alimentaci√≥n, Transporte, Salario"
        #nombreInput="ngModel"
      />
      <div *ngIf="nombreInput.invalid && (nombreInput.dirty || nombreInput.touched)" class="field-error">
        El nombre es obligatorio.
      </div>
    </div>
    
    <div class="form-group">
      <label for="descripcion">Descripci√≥n (opcional)</label>
      <input 
        id="descripcion"
        [(ngModel)]="categoriaEnFormulario.descripcion" 
        name="descripcion"
        placeholder="Breve descripci√≥n de la categor√≠a"
      />
    </div>
    
    <div class="form-actions">
      <button type="submit" [disabled]="categoriaForm.invalid">
        {{ modoEdicion ? 'Guardar Cambios' : 'Agregar Categor√≠a' }}
      </button>
      <button type="button" *ngIf="modoEdicion" (click)="cancelarEdicion()" class="btn-cancel">
        Cancelar
      </button>
    </div>
  </form>
  
  <hr class="divider">

  <div class="section-header">
    <h3>Categor√≠as Existentes</h3>
    <button type="button" *ngIf="modoEdicion" (click)="prepararFormularioParaAgregar()" class="btn-add-new">
      + Agregar Nueva Categor√≠a
    </button>
  </div>
  
  <div *ngIf="loading" class="loading">
    Cargando categor√≠as...
  </div>

  <div class="table-responsive" *ngIf="!loading && categorias.length > 0">
    <table>
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Descripci√≥n</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let cat of categorias">
          <td>
            <span class="categoria-icon">üè∑Ô∏è</span>
            {{ cat.nombre }}
          </td>
          <td>{{ cat.descripcion || 'Sin descripci√≥n' }}</td>
          <td class="actions">
            <button (click)="iniciarEdicion(cat)" class="btn-edit" title="Editar categor√≠a">‚úèÔ∏è Editar</button>
            <button (click)="eliminarCategoria(cat.id)" class="btn-delete" title="Eliminar categor√≠a">üóëÔ∏è Eliminar</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  
  <div *ngIf="!loading && categorias.length === 0 && !modoEdicion" class="info">
    No hay categor√≠as registradas. 
    <p>Crea una categor√≠a para organizar mejor tus finanzas.</p>
  </div>
</div>